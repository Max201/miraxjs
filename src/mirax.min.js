var Mirax=function(){var t=this;this.PluginManager=function(t){this.mx=t,this.load=function(t,e){e.constructor.name=t,this.mx.__defineGetter__(t,e)}},this.plugin=new this.PluginManager(this),this.done=function(t){this.evt("domloaded").handle(t)},document.addEventListener("DOMContentLoaded",function(e){t.evt("domloaded").trigger(e)}),(window.onpopstate=function(){var e,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(n," "))},i=window.location.search.substring(1);for(t._request_parameters={};e=r.exec(i);)t._request_parameters[o(e[1])]=o(e[2])})()};window.mx=new Mirax,mx.plugin.load("rstr",function(){var t=function(t,e){for(var n=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz~!@#$%^&*()-+|;:",r=t||8,o="",i=0;r>i;i++){var u=Math.floor(Math.random()*n.length);o+=n.substring(u,u+1)}return o};return function(e,n){return t(e,n)}}),mx.plugin.load("req",function(){var t=function(t,e){return"undefined"!=typeof t&&t?"undefined"!=typeof mx._request_parameters[t]&&mx._request_parameters[t]?mx._request_parameters[t]:e||null:mx._request_parameters};return function(e,n){return t(e,n)}}),mx.plugin.load("query",function(){var t=function(t){t=mx.set(t,mx.req());var e,n=[];for(e in t)n.push(e+"="+encodeURIComponent(t[e]));return n.join("&")};return function(e){return t(e)}}),mx.plugin.load("go",function(){var t=function(t,e){var n=t||document.location.href;e=e||0,e>0?setTimeout(function(){document.location.href=n},1e3*e):document.location.href=n};return function(e,n){return t(e,n)}}),mx.plugin.load("translit",function(){var t=function(t){var e=function(){var e=1,n=Math.abs(e);return e===n?(t=t.replace(/(\u0456(?=.[^\u0430\u0435\u0438\u043E\u0443\u044A\s]+))/gi,"$1`"),[function(t,e){var i;(i=t[0]||t[n])&&(o[e]=i,r.push(e))},function(t){return t.replace(/i``/gi,"i`").replace(/((c)z)(?=[ieyj])/gi,"$2")}]):(t=t.replace(/(c)(?=[ieyj])/gi,"$1z"),[function(t,e){var i;(i=t[0]||t[n])&&(o[i]=e,r.push(i))},function(t){return t}])}(),n={"щ":["","ŝ","","sth","","shh","shh"],"я":["","â","ya","ya","","ya","ya"],"є":["","ê","","","","","ye"],"ѣ":["","ě","","ye","","ye",""],"і":["","ì","i","i","","i","i"],"ї":["","ï","","","","","yi"],"ё":["","ë","yo","","","yo",""],"ю":["","û","yu","yu","","yu","yu"],"ж":["zh","ž"],"ч":["ch","č"],"ш":["sh","š"],"ѳ":["","f̀","","fh","","fh",""],"џ":["","d̂","","","dh","",""],"ґ":["","g̀","","","","","g"],"ѓ":["","g","","","g","",""],"ѕ":["","s","","","z","",""],"ќ":["","k","","","k","",""],"љ":["","l","","","l","",""],"њ":["","n","","","n","",""],"э":["","è","e","","","e",""],"ъ":["","ʺ","","","","",""],"ы":["","y","y","","","y",""],"ў":["","ǔ","u","","","",""],"ѫ":["","ǎ","","o","","",""],"ѵ":["","ỳ","","yh","","yh",""],"ц":["cz","c"],"а":["a"],"б":["b"],"в":["v"],"г":["g"],"д":["d"],"е":["e"],"з":["z"],"и":["","i","","i","i","i","y"],"й":["","j","j","j","","j","j"],"к":["k"],"л":["l"],"м":["m"],"н":["n"],"о":["o"],"п":["p"],"р":["r"],"с":["s"],"т":["t"],"у":["u"],"ф":["f"],"х":["x","h"],"ь":["'","","","","","",""],"ј":["","j","","","j","",""],"’":["",""],"№":["#"]},r=[],o={};for(var i in n)e[0](n[i],i);return e[1](t.replace(new RegExp(r.join("|"),"gi"),function(t){return t.toLowerCase()===t?o[t]:o[t.toLowerCase()].toUpperCase()}))};return function(e){return t(e)}}),mx.plugin.load("slug",function(){var t=function(t){var e=t.toLowerCase().trim();return mx.translit(e).replace(/\s+/g,"_").replace(/[^a-z0-9\-_]+/g,"")};return function(e){return t(e)}}),mx.plugin.load("type",function(){var t=function(t){this["var"]=t,this.type=typeof t,"undefined"==this.type?this["class"]="undefined":null==this["var"]?this["class"]="null":this["class"]="undefined"!=typeof t.constructor?t.constructor.name:this.type};return t.prototype.isDict=function(){return"object"==this.type&&"undefined"==typeof this.type.pop},t.prototype.isList=function(){return"object"==this.type&&"undefined"!=typeof this.type.pop},t.prototype.isString=function(){return"string"==this.type},t.prototype.isFunction=function(){return"function"==this.type},t.prototype.isDom=function(){return this["class"].indexOf("HTML")>-1&&this["class"].indexOf("Element")>-1||"Window"==this["class"]||"HTMLDocument"==this["class"]},t.prototype.isDomList=function(){return this.isList()&&mx.type(this["var"][0]).isDom()},function(e){return new t(e)}}),mx.plugin.load("route",function(){var t=this,e=function(e){this.route=e;var n=this;"undefined"==typeof t._routing_init&&(t._routing_init=!0,t._route_map={},t.dom(window).on("hashchange",function(){var e,r,o=n.location();for(e in t._route_map)if(e==o){r=t._route_map[e];break}t.http(r)})),this.request={url:"",method:"GET",data:{}}};return e.prototype.location=function(){var t=window.location.hash;return t.indexOf("#!")>-1&&(t=t.substr(2)),t.indexOf("#")>-1&&(t=t.substr(1)),t},e.prototype.src=function(t,e){return this.request.url=t,this.request.data=e||{},this},e.prototype.srcPost=function(t,e){return this.src(t,e),this.request.method="POST",this},e.prototype["final"]=function(e,n){var r=this;this.request.callback=function(o){var i=o,u=t.dom(e);t.type(n).isFunction()&&(i=n(o,r.request)),u.content(i)},t._route_map[this.route]=this.request},function(t){return new e(t)}}),mx.plugin.load("evt",function(){var t=this,e=function(e){e=e?e.trim().toLowerCase():"","undefined"==typeof t._evt&&(t._evt={}),"undefined"==typeof t._evt[e]&&(t._evt[e]=[]),this.event=e};return e.prototype.handle=function(e){"function"==typeof e&&t._evt[this.event].push(e)},e.prototype.trigger=function(e){var n;for(n=0;n<t._evt[this.event].length;n++){var r=t._evt[this.event][n];r(e)}},function(t){return new e(t)}}),mx.plugin.load("set",function(){return function(t,e){var n;if(e=e||{},"undefined"!=typeof t){for(n in e)t.hasOwnProperty(n)||(t[n]=e[n]);return t}return e}}),mx.plugin.load("func",function(){return function(t,e){return"function"==typeof t?t:("function"!=typeof e&&(e=function(){}),e)}}),mx.plugin.load("http",function(){var t=this,e=function(e,n){return this.conf={url:null,method:"GET",type:"html",headers:{"Content-Type":this.type("html")},callback:function(t,e){},change:function(t,e){},before:function(t){},after:function(t,e){},update:function(t,e){}},"string"==typeof e?(this.conf=t.set({url:e,callback:t.func(n)},this.conf),void this.request()):void("object"==typeof e&&(this.conf=t.set(e,this.conf),this.request()))};return e.prototype.query=function(t){var e,n=[];for(e in t)n.push(e+"="+encodeURIComponent(t[e]));return n.join("&")},e.prototype.form=function(t){var e,n=new FormData;for(e in t)n.append(e,t[e]);return n},e.prototype.process_data=function(e){return"string"==typeof e?t.dom(e).form():e},e.prototype.type=function(t){var e={json:"application/json",html:"text/html",text:"text/plain",css:"text/stylesheet",js:"text/javascript"};return e[t.toLowerCase()]},e.prototype.decode=function(t,e){var n={json:JSON.parse};return e.hasOwnProperty(e.toLowerCase())?n[e.toLowerCase()](t):t},e.prototype.extends_get=function(e,n){var r,o,i={};if(!e)return n||{};if(e=e.split("?"),1==e.length)return n;for(e=e[1].split("&"),r=0;r<e.length;r++)o=e[r].split("="),i[o[0]]=null,o.length>1&&(i[o[0]]=o[1]);return t.set(n,i)},e.prototype.request=function(){var e,n=new XMLHttpRequest,r=this;if(this.conf.data=this.process_data(this.conf.data),n.onreadystatechange=function(){var e="undefined"!=typeof n.responseText?r.decode(n.responseText,n.responseType):null;4==n.readyState&&200==n.status?t.func(r.conf.after)(e,n):t.func(r.conf.update)(e,n)},n.onload=function(){var e="undefined"!=typeof this.responseText?r.decode(this.responseText,this.responseType):null;t.func(r.conf.callback)(e,n)},this.conf.method=this.conf.method.trim().toUpperCase(),"GET"==this.conf.method){var o=this.query(this.extends_get(this.conf.url,this.conf.data));this.conf.url=this.conf.url.split("?")[0],n.open(this.conf.method,this.conf.url+(o.length?"?"+o:""))}else n.open(this.conf.method,this.conf.url,!0);for(e in this.conf.headers)n.setRequestHeader(e,this.conf.headers[e]);t.func(this.conf.before)(n),"GET"==this.conf.method?n.send():(n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(this.form(this.conf.data)))},function(t,n){return new e(t,n)}}),mx.plugin.load("dom",function(){var t=function(t){if(!mx.type(t).isDom())throw new TypeError("Wrong input type");this.element=t,this.value=null,this.name=t&&"undefined"!=typeof this.element.getAttribute?t.getAttribute("name"):null,this.method=method=this.element.tagName.toLowerCase(),"undefined"!=typeof this[this.method]&&(this.value=this[this.method]())};t.prototype.set=function(t){return"undefined"!=typeof this[this.method]&&this[this.method](t),this},t.prototype.select=function(t){var e,n=this.element.querySelectorAll("option"),r=null;if("undefined"==t){for(e=0;e<n.length;e++)n[e].selected&&(r=n[e].value);return r}for(e=0;e<n.length;e++)n[e].value==t?(n[e].selected=!0,n[e].setAttribute("selected","selected")):(n[e].selected=!1,n[e].removeAttribute("selected"));return this},t.prototype.button=function(t){return"undefined"==typeof t?this.element.value:(this.element.value=t,this)},t.prototype.input=function(t){var e,n;if("undefined"==typeof t)switch(this.element.type){case"checkbox":return e=this.element.hasAttribute("data-default")?this.element.getAttribute("data-default"):"",this.element.checked?this.element.value:e;case"radio":return n=null,this.name?mx.dom('[name="'+this.name+'"][type="radio"]').each(function(t){t.checked&&(n=t.value)}):n=this.element.value,n;default:return this.element.value}else switch(this.element.type){case"checkbox":"undefined"!=typeof t&&t?(this.element.checked=!0,this.element.setAttribute("checked","checked")):(this.element.checked=!1,this.element.removeAttribute("checked"));break;case"radio":var r=mx.dom('[type="radio"][name="'+this.name+'"]');r.each(function(e){return e.value==t?(e.checked=!0,e.setAttribute("checked","checked")):(e.checked=!1,e.removeAttribute("checked")),console.log(e.value),e});break;default:this.element.value=t}return this},t.prototype.textarea=function(t){return"undefined"==typeof t?this.element.textContent:(this.element.textContent=t,this)};var e=function(t){var e=mx.type(t);if(e.isDom())this.elements=[t];else if(e.isString())this.elements=document.querySelectorAll(t);else{if(!e.isList()&&!e.isDict())throw new TypeError("Wrong DOM-Selection");this.elements=t}};return e.prototype.each=function(t){var e;for(e=0;e<this.elements.length;e++)this.elements[e]=mx.func(t)(this.elements[e]);return this},e.prototype.remove=function(){return this.each(function(t){t.parentNode.removeChild(t)}),this},e.prototype.css=function(t,e){var n={};return"undefined"!=typeof e?n[t]=e:n=t,this.each(function(t){var e;for(e in n)t.style.hasOwnProperty(e)&&(t.style[e]=n[e]);return t}),this},e.prototype.content=function(t){if("undefined"==typeof t||!t){var t=new Array;return this.each(function(e){return t.push(e.innerHTML),e}),t}return this.each(function(e){return e.innerHTML=t,e}),this},e.prototype.html=function(t){if("undefined"==typeof t||!t){var t=new Array;return this.each(function(e){return t.push(e.outerHTML),e}),t}return this.each(function(e){return e.outerHTML=t,e}),this},e.prototype.text=function(t){if("undefined"==typeof t||!t){var t=new Array;return this.each(function(e){return t.push(e.textContent),e}),t}return this.each(function(e){return e.textContent=t,e}),this},e.prototype.child=function(t){var e=[];return this.each(function(n){var r,o=n.querySelectorAll(t);for(r=0;r<o.length;r++)e.push(o[r]);return n}),mx.dom(e)},e.prototype.attr=function(t,e){if("undefined"==typeof e){var n=[];return this.each(function(e){return e.hasAttribute(t)?n.push(e.getAttribute(t)):n.push(null),e}),1==n.length?n[0]:n}this.each(function(n){return n.hasAttribute(t)&&n.setAttribute(t,e),n})},e.prototype.val=function(e){if("undefined"!=typeof this.elements[0]&&"FORM"==this.elements[0].tagName)return mx.dom(this.elements[0].querySelectorAll("input, select, button, textarea")).val(e);var n=[];return this.each(function(r){var o=new t(r);return"undefined"==typeof e?n.push(o.value):o.set(e),r}),"undefined"!=typeof e?(this.trigger("input"),this.trigger("change"),this):1==n.length?n[0]:n},e.prototype.form=function(e){if("undefined"!=typeof this.elements[0]&&"FORM"==this.elements[0].tagName)return mx.dom(this.elements[0].querySelectorAll("input, select, button, textarea")).form(e);var n={};return this.each(function(r){var o=new t(r);o.name&&("undefined"!=typeof e&&"undefined"!=typeof e[o.name]?o.set(e[o.name]):n[o.name]=o.value)}),"undefined"==typeof e?n:this},e.prototype.hide=function(){return this.css("display","none"),this},e.prototype.show=function(t){return this.css("display",t||"block"),this},e.prototype.on=function(t,e){return this.each(function(n){n.addEventListener(t,e)}),this},e.prototype.trigger=function(t){var e=this;return this.each(function(n){e.triggerEvent(t,n)}),this},e.prototype.triggerEvent=function(t,e){var n;if(e.ownerDocument)n=e.ownerDocument;else{if(9!=e.nodeType)throw new Error("Invalid node passed to fireEvent: "+e.id);n=e}var r;if(e.dispatchEvent){var o="";switch(t){case"hashchange":o="HashChangeEvent";break;case"click":case"mousedown":case"mouseup":case"mouseenter":case"mouseover":case"mouseleave":case"mousemove":o="MouseEvents";break;case"focus":case"change":case"blur":case"select":o="HTMLEvents";break;default:o="UIEvent"}r=n.createEvent(o),r.initEvent(t,!0,!0),r.synthetic=!0,e.dispatchEvent(r,!0)}else e.fireEvent&&(r=n.createEventObject(),r.synthetic=!0,e.dispatchEvent("on"+t,!0));return this},function(t){return new e(t)}});